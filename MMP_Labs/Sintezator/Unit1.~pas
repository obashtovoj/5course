unit Unit1;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Menus, StdCtrls, ComCtrls, ExtCtrls, MMSystem;

type
  TForm1 = class(TForm)
    ShC3: TShape;
    ShD3: TShape;
    ShE3: TShape;
    ShF3: TShape;
    ShG3: TShape;
    ShA3: TShape;
    ShB3: TShape;
    ShC4: TShape;
    ShD4: TShape;
    ShE4: TShape;
    ShF4: TShape;
    ShG4: TShape;
    ShA4: TShape;
    ShB4: TShape;
    ShC5: TShape;
    ShDb3: TShape;
    ShEb3: TShape;
    ShGb3: TShape;
    ShAb3: TShape;
    ShH3: TShape;
    ShDb4: TShape;
    ShEb4: TShape;
    ShGb4: TShape;
    ShAb4: TShape;
    ShH4: TShape;
    TrackBar1: TTrackBar;
    ListBox1: TListBox;
    MainMenu1: TMainMenu;
    Label1: TLabel;
    K2: TMenuItem;
    K4: TMenuItem;
    Timer1: TTimer;
    S1: TMenuItem;
    S2: TMenuItem;
    S3: TMenuItem;
    S4: TMenuItem;
    CheckBox1: TCheckBox;
    Label2: TLabel;
    Label3: TLabel;
    Label4: TLabel;
    Label5: TLabel;
    Label6: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Label9: TLabel;
    Label10: TLabel;
    Label12: TLabel;
    Label13: TLabel;
    Label14: TLabel;
    Label15: TLabel;
    Label16: TLabel;
    Label17: TLabel;
    Label18: TLabel;
    S5: TMenuItem;
    S6: TMenuItem;
    procedure FormCreate(Sender: TObject);
    procedure Timer1Timer(Sender: TObject);
    procedure ListBox1Click(Sender: TObject);
    procedure TrackBar1Change(Sender: TObject);
    procedure FormKeyPress(Sender: TObject; var Key: Char);
    procedure FormKeyUp(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure ShC3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShC3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShDb3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShDb3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShD3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShD3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShEb3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShEb3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShE3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShE3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShF3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShF3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShGb3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShGb3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShG3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShG3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShAb3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShAb3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShA3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShA3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShH3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShH3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShB3MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShB3MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShC4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShC4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShDb4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShDb4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShD4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShD4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShEb4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShEb4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShE4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShE4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShF4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShF4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShGb4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShGb4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShG4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShG4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShAb4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShAb4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShA4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShA4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShH4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShH4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShB4MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShB4MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShC5MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure ShC5MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure FormPaint(Sender: TObject);
    procedure FormDestroy(Sender: TObject);
    procedure S1Click(Sender: TObject);
    procedure S2Click(Sender: TObject);
    procedure S3Click(Sender: TObject);
    procedure S4Click(Sender: TObject);
    procedure K4Click(Sender: TObject);
    procedure CheckBox1MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure S5Click(Sender: TObject);
    procedure S6Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  bm:TBitMap; MIDIDevices:TStringList;
  hMidi,t,no,midimsg,n,n2:integer;
  vel:integer=127;
  BelKlavNag:TColor=$00CFCFCF;BelKlav:TColor=$00E9E9E9;ChorKlavNag:TColor=$001B1B1B;ChorKlav:TColor=$00373737;
  skin:string='skins/balsaholz.bmp';
  NoFlags:array[0..24] of boolean;
  Instruments:array [0..127] of String=( 'AcousticGrandPano', 'BrightAcousticPiano', 'ElectricGrandPiano','HonkyTonkPiano','ElectricPiano1','ElectricPiano2','Harpsichord',
  'Clavinet','Celesta','Glockenspiel','MusicBox','Vibraphone', 'Marimba','Xylophone', 'TubularBells','Dulcimer','DrawbarOrgan',
  'PercussiveOrgan','RockOrgan','ChurchOrgan','ReedOrgan','Accordion', 'Harmonica', 'TangoAccordion', 'AcousticNylonGuitar', ' AcousticSteelGuitar', 'JazzElectricGuitar', 'CleanElectricGuitar', 'MutedElectricGuitar', 'OverdrivenGuitar', 'DistortionGuitar',
  'GuitarHarmonics',  'AcousticBass', 'FingeredElectricBass', 'PickedElectricBass', 'FretlessBass', 'SlapBass1', 'SlapBass2',
  'SynthBass1', 'SynthBass2', 'Violin', 'Viola', 'Cello', 'Contrabass', 'TremoloStrings', 'PizzicatoStrings', 'OrchestralHarp',
  'Timpani', 'StringEnsemble1', 'StringEnsemble2', 'SynthStrings1', 'SynthStrings2', 'ChoirAahs', 'VoiceOohs', 'SynthVoice',
  'OrchestraHit', 'Trumpet', 'Trombone','Tuba', 'MutedTrumpet', 'FrenchHorn', 'BrassSection', 'SynthBrass1', 'SynthBrass2',
  'SopranoSax', 'AltoSax', 'TenorSax', 'BaritoneSax', 'Oboe', 'EnglishHorn', 'Bassoon', 'Clarinet', 'Piccolo', 'Flute', 'Recorder',
  'PanFlute', 'BlownBottle', 'Shakuhachi', 'Whistle', 'Ocarina', 'SquareLead', 'SawtoothLead', 'CalliopeLead', 'ChiffLead',
  'CharangLead', 'VoiceLead', 'FifthsLead', 'BassandLead', 'NewAgePad', 'WarmPad', 'PolySynthPad', 'ChoirPad', 'BowedPad',
  'MetallicPad', 'HaloPad', 'SweepPad', 'SynthFXRain', 'SynthFXSoundtrack', 'SynthFXCrystal', 'SynthFXAtmosphere', 'SynthFXBrightness',
  'SynthFXGoblins', 'SynthFXEchoes', 'SynthFXSciFi', 'Sitar', 'Banjo', 'Shamisen', 'Koto', 'Kalimba', 'Bagpipe', 'Fiddle', 'Shanai',
  'TinkleBell', 'Agogo', 'SteelDrums', 'Woodblock', 'TaikoDrum', 'MelodicTom', 'SynthDrum', 'ReverseCymbal', 'GuitarFretNoise',
  'BreathNoise', 'Seashore', 'BirdTweet', 'TelephoneRing', 'Helicopter', 'Applause', 'Gunshot');

implementation

{$R *.dfm}

procedure GetMIDIOutDevices(Devices: TStrings);
var
i, DNum: Integer;
Caps: TMIDIOUTCAPSA;
begin
DNum := MIDIOutGetNumDevs;
for i := 0 to DNum - 1 do
begin
MIDIOutGetDevCaps(i,@Caps, SizeOf(TMIDIOutCapsA));
Devices.Add(string(Caps.szPname));
end;
end;

procedure TForm1.FormCreate(Sender: TObject);
var i,ii: integer;
nit: string;
begin
for ii:=0 to 24 do
begin
NoFlags[ii]:=true;
end;
DoubleBuffered:=True;
bm:= TBitMap.Create;
bm.LoadFromFile(skin);
form1.Repaint;
s3.GroupIndex:=1;
s3.RadioItem:=true;
s3.Checked:=true;
midiOutOpen(@hmidi, 0, 0, 0, 0);
//Розглядається ситуація, коли натиснута клавіша з клавіатури
Form1.KeyPreview:= true;
//Регулюється гучність натиснення клавіш
form1.Label1.Caption:=floattostr(vel);
//Список інструментів складається за допомогою циклу
for i:=0 to 127 do
begin
nit:=(FloatToStr(i)+'.'+Instruments[i]);
ListBox1.Items.add(FloatToStr(i)+'.'+Instruments[i]);
end;
// Звернення до процедури виклику міді пристроїв
MIDIDevices := TStringList.Create;
try
GetMIDIOutDevices(MIDIDevices);
finally
MIDIDevices.Free;
end;
//Акорд, який звучить при відкритті програмного продукту
midimsg := $C0+$100*101;   //говоримо, яким інструментом його зіграти
midiOutShortMsg (hmidi, midimsg);
midimsg := $90 + ((48) * $100) + ((80) * $10000) + 0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $90 + ((60) * $100) + ((80) * $10000) + 0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $90 + ((67) * $100) + ((80) * $10000) + 0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $90 + ((74) * $100) + ((80) * $10000) + 0;
midiOutShortMsg (hmidi, midimsg);

end;

procedure TForm1.Timer1Timer(Sender: TObject);
begin
midimsg := $80 + ((48) * $100) +  0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $80 + ((60) * $100) +  0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $80 + ((67) * $100) +  0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $80 + ((74) * $100) +  0;
midiOutShortMsg (hmidi, midimsg);
midimsg := $C0+$100*00;        //говоримо, яким інструментом його зіграти
midiOutShortMsg (hmidi, midimsg);
Form1.Timer1.Enabled:=false;
end;

procedure TForm1.ListBox1Click(Sender: TObject);
var ni:integer; //визначається номер інструменту
begin
ni:=ListBox1.ItemIndex;
midimsg := $C0+$100*ni;
midiOutShortMsg (hmidi, midimsg);
end;

procedure TForm1.TrackBar1Change(Sender: TObject);
var i:integer;
begin
for i:=0 to 127 do
begin
if TrackBar1.Position=i then
vel:=127-i;
Form1.Label1.Caption:=floattostr(vel);
end;
end;

procedure TForm1.FormKeyPress(Sender: TObject; var Key: Char);
begin
if key='a' then begin no:=60; ShC3.Brush.Color:=BelKlavNag; end;
if key='w' then begin no:=61; ShDb3.Brush.Color:=ChorKlavNag; end;
if key='s' then begin no:=62; ShD3.Brush.Color:=BelKlavNag;end;
if key='e' then begin no:=63; ShEb3.Brush.Color:=ChorKlavNag;end;
if key='d' then begin no:=64; ShE3.Brush.Color:=BelKlavNag;end;
if key='f' then begin no:=65; ShF3.Brush.Color:=BelKlavNag;end;
if key='t' then begin no:=66; ShGb3.Brush.Color:=ChorKlavNag;end;
if key='g' then begin no:=67; ShG3.Brush.Color:=BelKlavNag;end;
if key='y' then begin no:=68; ShAb3.Brush.Color:=ChorKlavNag;end;
if key='h' then begin no:=69; ShA3.Brush.Color:=BelKlavNag;end;
if key='u' then begin no:=70; ShH3.Brush.Color:=ChorKlavNag;end;
if key='j' then begin no:=71; ShB3.Brush.Color:=BelKlavNag;end;
if key='k' then begin no:=72; ShC4.Brush.Color:=BelKlavNag;end;
if key='o' then begin no:=73; ShDb4.Brush.Color:=ChorKlavNag;end;
if key='l' then begin no:=74; ShD4.Brush.Color:=BelKlavNag;end;
if key='p' then begin no:=75; ShEb4.Brush.Color:=ChorKlavNag;end;
if key='A' then begin no:=72; ShC4.Brush.Color:=BelKlavNag;end;
if key='W' then begin no:=73; ShDb4.Brush.Color:=ChorKlavNag;end;
if key='S' then begin no:=74; ShD4.Brush.Color:=BelKlavNag;end;
if key='E' then begin no:=75; ShEb4.Brush.Color:=ChorKlavNag;end;
if key='D' then begin no:=76; ShE4.Brush.Color:=BelKlavNag;end;
if key='F' then begin no:=77; ShF4.Brush.Color:=BelKlavNag;end;
if key='T' then begin no:=78; ShGb4.Brush.Color:=ChorKlavNag;end;
if key='G' then begin no:=79; ShG4.Brush.Color:=BelKlavNag;end;
if key='Y' then begin no:=80; ShAb4.Brush.Color:=ChorKlavNag;end;
if key='H' then begin no:=81; ShA4.Brush.Color:=BelKlavNag;end;
if key='U' then begin no:=82; ShH4.Brush.Color:=ChorKlavNag;end;
if key='J' then begin no:=83; ShB4.Brush.Color:=BelKlavNag;end;
if key='K' then begin no:=84; ShC5.Brush.Color:=BelKlavNag;end;
if (NoFlags[no-60]=true) and ((key='a') or (key='w') or (key='s') or
(key='e') or (key='d') or (key='f') or (key='t') or (key='g') or
(key='y') or (key='h') or (key='u') or (key='j') or (key='k') or (key='o')
or (key='l') or (key='p') or (key='A') or (key='W') or (key='S') or (key='E')
or (key='D') or (key='F') or (key='T') or (key='G') or (key='Y') or (key='H')
or (key='U') or (key='J') or (key='K')) then
begin
NoFlags[no-60]:=false;
midimsg := $90 + ((no) * $100) + ((vel) * $10000) + 0;
midiOutShortMsg (hmidi, midimsg);
end;
end;

procedure TForm1.FormKeyUp(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
if key=ord('A') then begin NoFlags[0]:=true; NoFlags[12]:=true; n:=60;n2:=72;ShC3.Brush.Color:=BelKlav;ShC4.Brush.Color:=BelKlav;end;
if key=ord('W') then begin NoFlags[1]:=true; NoFlags[13]:=true; n:=61;n2:=73;ShDb3.Brush.Color:=ChorKlav;ShDb4.Brush.Color:=ChorKlav;end;
if key=ord('S') then begin NoFlags[2]:=true; NoFlags[14]:=true; n:=62;n2:=74;ShD3.Brush.Color:=BelKlav;ShD4.Brush.Color:=BelKlav;end;
if key=ord('E') then begin NoFlags[3]:=true; NoFlags[15]:=true; n:=63;n2:=75;ShEb3.Brush.Color:=ChorKlav;ShEb4.Brush.Color:=ChorKlav;end;
if key=ord('D') then begin NoFlags[4]:=true; NoFlags[16]:=true; n:=64;n2:=76;ShE3.Brush.Color:=BelKlav;ShE4.Brush.Color:=BelKlav;end;
if key=ord('F') then begin NoFlags[5]:=true; NoFlags[17]:=true; n:=65;n2:=77;ShF3.Brush.Color:=BelKlav;ShF4.Brush.Color:=BelKlav;end;
if key=ord('T') then begin NoFlags[6]:=true; NoFlags[18]:=true; n:=66;n2:=78;ShGb3.Brush.Color:=ChorKlav;ShGb4.Brush.Color:=ChorKlav;end;
if key=ord('G') then begin NoFlags[7]:=true; NoFlags[19]:=true; n:=67;n2:=79;ShG3.Brush.Color:=BelKlav;ShG4.Brush.Color:=BelKlav;end;
if key=ord('Y') then begin NoFlags[8]:=true; NoFlags[20]:=true; n:=68;n2:=80;ShAb3.Brush.Color:=ChorKlav;ShAb4.Brush.Color:=ChorKlav;end;
if key=ord('H') then begin NoFlags[9]:=true; NoFlags[21]:=true; n:=69;n2:=81;ShA3.Brush.Color:=BelKlav;ShA4.Brush.Color:=BelKlav;end;
if key=ord('U') then begin NoFlags[10]:=true; NoFlags[22]:=true; n:=70;n2:=82;ShH3.Brush.Color:=ChorKlav;ShH4.Brush.Color:=ChorKlav;end;
if key=ord('J') then begin NoFlags[11]:=true; NoFlags[23]:=true; n:=71;n2:=83;ShB3.Brush.Color:=BelKlav;ShB4.Brush.Color:=BelKlav;end;
if key=ord('K') then begin NoFlags[12]:=true; NoFlags[24]:=true; n:=72;n2:=84;ShC4.Brush.Color:=BelKlav;ShC5.Brush.Color:=BelKlav;end;
if key=ord('O') then begin NoFlags[13]:=true; n:=73; ShDb4.Brush.Color:=ChorKlav;end;
if key=ord('L') then begin NoFlags[14]:=true; n:=74;ShD4.Brush.Color:=BelKlav;end;
if key=ord('P') then begin NoFlags[15]:=true; n:=75;ShEb4.Brush.Color:=ChorKlav;end;
midimsg := $80 + ((n) * $100) +0 ;
midiOutShortMsg (hmidi, midimsg);
midimsg := $80 + ((n2) * $100) +0 ;
midiOutShortMsg (hmidi, midimsg);
end;

procedure TForm1.ShC3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$3C80);
end;

procedure TForm1.ShC3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $3C90+((vel) * $10000));
end;

procedure TForm1.ShDb3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShDb3.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $3D90+((vel) * $10000));
end;

procedure TForm1.ShDb3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShDb3.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$3D80);
end;

procedure TForm1.ShD3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShD3.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $3E90+((vel) * $10000));
end;

procedure TForm1.ShD3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShD3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$3E80);
end;

procedure TForm1.ShEb3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShEb3.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $3F90+((vel) * $10000));
end;

procedure TForm1.ShEb3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShEb3.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$3F80);
end;

procedure TForm1.ShE3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShE3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $4090+((vel) * $10000));
end;

procedure TForm1.ShE3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShE3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4080);
end;

procedure TForm1.ShF3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShF3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $4190+((vel) * $10000));
end;

procedure TForm1.ShF3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShF3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4180);
end;

procedure TForm1.ShGb3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShGb3.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4290+((vel) * $10000));
end;

procedure TForm1.ShGb3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShGb3.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4280);
end;

procedure TForm1.ShG3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShG3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $4390+((vel) * $10000));
end;

procedure TForm1.ShG3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShG3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4380);
end;

procedure TForm1.ShAb3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShAb3.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4490+((vel) * $10000));
end;

procedure TForm1.ShAb3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShAb3.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4480);
end;

procedure TForm1.ShA3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShA3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $4590+((vel) * $10000));
end;

procedure TForm1.ShA3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShA3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4580);
end;

procedure TForm1.ShH3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShH3.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4690+((vel) * $10000));
end;

procedure TForm1.ShH3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShH3.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4680);
end;

procedure TForm1.ShB3MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShB3.Brush.Color:=BelKlavNag; midiOutShortMsg (hmidi, $4790+((vel) * $10000));
end;

procedure TForm1.ShB3MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShB3.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4780);
end;

procedure TForm1.ShC4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $4890+((vel) * $10000));
end;

procedure TForm1.ShC4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4880);
end;

procedure TForm1.ShDb4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShDb4.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4990+((vel) * $10000));
end;

procedure TForm1.ShDb4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShDb4.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4980);
end;

procedure TForm1.ShD4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShD4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $4A90+((vel) * $10000));
end;

procedure TForm1.ShD4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShD4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4A80);
end;

procedure TForm1.ShEb4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShEb4.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4B90+((vel) * $10000));
end;

procedure TForm1.ShEb4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShEb4.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4B80);
end;

procedure TForm1.ShE4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShE4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $4C90+((vel) * $10000));
end;

procedure TForm1.ShE4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShE4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4C80);
end;

procedure TForm1.ShF4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShF4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $4D90+((vel) * $10000));
end;

procedure TForm1.ShF4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShF4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4D80);
end;

procedure TForm1.ShGb4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShGb4.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $4E90+((vel) * $10000));
end;

procedure TForm1.ShGb4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShGb4.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$4E80);
end;

procedure TForm1.ShG4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShG4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $4F90+((vel) * $10000));
end;

procedure TForm1.ShG4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShG4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$4F80);
end;

procedure TForm1.ShAb4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShAb4.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $5090+((vel) * $10000));
end;

procedure TForm1.ShAb4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShAb4.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$5080);
end;

procedure TForm1.ShA4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShA4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $5190+((vel) * $10000));
end;

procedure TForm1.ShA4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShA4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$5180);
end;

procedure TForm1.ShH4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShH4.Brush.Color:=ChorKlavNag; midiOutShortMsg (hmidi, $5290+((vel) * $10000));
end;

procedure TForm1.ShH4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShH4.Brush.Color:=ChorKlav;  midiOutShortMsg(hmidi,$5280);
end;

procedure TForm1.ShB4MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShB4.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $5390+((vel) * $10000));
end;

procedure TForm1.ShB4MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShB4.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$5380);
end;

procedure TForm1.ShC5MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC5.Brush.Color:=BelKlavNag;midiOutShortMsg (hmidi, $5490+((vel) * $10000));
end;

procedure TForm1.ShC5MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
ShC5.Brush.Color:=BelKlav;  midiOutShortMsg(hmidi,$5480);
end;

procedure TForm1.FormPaint(Sender: TObject);
var x, y: integer;
begin
for x := 0 to (Form1.ClientWidth div bm.Width) do
for y := 0 to (Form1.ClientHeight div bm.Height) do
Form1.Canvas.Draw(x * bm.Width, y * bm.Height, bm);
end;

procedure TForm1.FormDestroy(Sender: TObject);
begin
bm.Destroy;
end;

procedure TForm1.S1Click(Sender: TObject);
begin
skin:='skins/macore.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s1.GroupIndex:=1;
s1.RadioItem:=true;
s1.Checked:=true;
end;

procedure TForm1.S2Click(Sender: TObject);
begin
skin:='skins/tanne.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s2.GroupIndex:=1;
s2.RadioItem:=true;
s2.Checked:=true;
end;

procedure TForm1.S3Click(Sender: TObject);
begin
skin:='skins/balsaholz.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s3.GroupIndex:=1;
s3.RadioItem:=true;
s3.Checked:=true;
end;

procedure TForm1.S4Click(Sender: TObject);
begin
skin:='skins/birke.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s4.GroupIndex:=1;
s4.RadioItem:=true;
s4.Checked:=true;
end;

procedure TForm1.K4Click(Sender: TObject);
begin
Close;
end;

procedure TForm1.CheckBox1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
Label2.Visible:=CheckBox1.Checked;
Label3.Visible:=CheckBox1.Checked;
Label4.Visible:=CheckBox1.Checked;
Label5.Visible:=CheckBox1.Checked;
Label6.Visible:=CheckBox1.Checked;
Label7.Visible:=CheckBox1.Checked;
Label8.Visible:=CheckBox1.Checked;
Label9.Visible:=CheckBox1.Checked;
Label10.Visible:=CheckBox1.Checked;
Label12.Visible:=CheckBox1.Checked;
Label13.Visible:=CheckBox1.Checked;
Label14.Visible:=CheckBox1.Checked;
Label15.Visible:=CheckBox1.Checked;
Label16.Visible:=CheckBox1.Checked;
Label17.Visible:=CheckBox1.Checked;
Label18.Visible:=CheckBox1.Checked;
end;

procedure TForm1.S5Click(Sender: TObject);
begin
skin:='skins/kiefer.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s5.GroupIndex:=1;
s5.RadioItem:=true;
s5.Checked:=true;
end;

procedure TForm1.S6Click(Sender: TObject);
begin
skin:='skins/laurel.bmp';
bm.LoadFromFile(skin);
form1.Repaint;
s6.GroupIndex:=1;
s6.RadioItem:=true;
s6.Checked:=true;
end;

end.
